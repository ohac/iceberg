!!! 5
%html
  %head
    %title Online Storage - Iceberg
    %meta{:property => 'twitter:card', :content => 'summary'}
    %meta{:name => 'twitter:title', :content => 'Online Storage - Iceberg'}
    %meta{:name => 'twitter:description',
        :content => 'Store and share files on Iceberg.'}
    %link{:href => "/style.css", :rel => "stylesheet", :type => "text/css",
        :media => "screen"}
    - cdn = 'http://maxcdn.bootstrapcdn.com/bootstrap/3.3.1'
    %link{:href => "#{cdn}/css/bootstrap.min.css", :rel => "stylesheet"}
    %link{:href => "#{cdn}/css/bootstrap-theme.min.css", :rel => "stylesheet"}
    %link{:href => "/starter-template.css", :rel => "stylesheet"}
    %link{:href => "/carousel.css", :rel => "stylesheet"}
  %body
    %nav{:class => "navbar navbar-inverse navbar-fixed-top"}
      %div.container
        %div.navbar-header
          %button{:type => "button", :class => "navbar-toggle collapsed",
              "data-toggle" => "collapse", "data-target" => "#navbar",
              "aria-expanded" => "false", "aria-controls" => "navbar"}
            %span.sr-only Toggle navigation
            %span.icon-bar
            %span.icon-bar
            %span.icon-bar
          %a.navbar-brand{:href => "#"} Online Storage - Iceberg
        %div#navbar{:class => "collapse navbar-collapse"}
          %ul{:class => "nav navbar-nav"}= partial :navbar
    %div.container
      %div.starter-template
        - if uploaded
          - name = uploaded[:name]
          - digest = uploaded[:digest]
          - encdigest = uploaded[:encdigest]
          - tripcode = uploaded[:tripcode]
          %input#name{:type => :hidden, :value => name}
          %input#digest{:type => :hidden, :value => digest}
          %input#encdigest{:type => :hidden, :value => encdigest}
          - success = true # TODO
          - alerttype = success ? 'alert-success' : 'alert-danger'
          %div{:class => "alert #{alerttype} alert-dismissible",
              :role => 'alert'}
            %button.close{:type => 'button', 'data-dismiss' => 'alert',
                'aria-label' => 'Close'}
              %span{'aria-hidden' => true} &times;
            Uploaded
            %br
            %a{:href => "/show/#{encdigest}?digest=#{digest}&filename=#{name}"}
              = name
            - if tripcode
              %br
              Tripcode:
              %a{:href => "/tripcode/#{tripcode}"}= tripcode
              %input#tripcode{:type => :hidden, :value => tripcode}

        %div{:id => "myCarousel", :class => "carousel slide", 'data-ride' => "carousel", 'data-interval' => 20000}
          %ol{:class => "carousel-indicators"}
            %li{'data-target' => "#myCarousel", 'data-slide-to' => 0, :class => "active"}
            %li{'data-target' => "#myCarousel", 'data-slide-to' => 1}
            %li{'data-target' => "#myCarousel", 'data-slide-to' => 2}
          %div{:class => "carousel-inner", :role => "listbox"}
            %div{:class => "item active"}
              %img{:src => "data:image/gif;base64,R0lGODlhAQABAIAAAHd3dwAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==", :alt => "First slide"}
              %div{:class => "container"}
                %div{:class => "carousel-caption"}
                  %h1 Your stuff, anywhere
                  %p You can share pictures, stories, designs, drawings, recordings, videos â€“ anything.
                  %p You can quickly share URL to view, download, and collaborate on all the files you want - no email attachment needed.
                  %p
                    - demourl = SETTING['local']['demourl'] || '#'
                    %a{:class => "btn btn-lg btn-primary", :href => demourl} Demo
            %div{:class => "item"}
              %img{:src => "data:image/gif;base64,R0lGODlhAQABAIAAAGZmZgAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==", :alt => "Second slide"}
              %div{:class => "container"}
                %div{:class => "carousel-caption"}
                  %h1 Safe and secure
                  %p Full SSL communication.
                  %p Iceberg secures your files with 128-bit AES encryption.
                  %p Everything's automatically private, so you control who sees what.
                  %p Server does not store your private encryption key.
                  %p Storing it into your browser's local storage.
            %div{:class => "item"}
              %img{:src => "data:image/gif;base64,R0lGODlhAQABAIAAAFVVVQAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw==", :alt => "Third slide"}
              %div{:class => "container"}
                %div{:class => "carousel-caption"}
                  %h1 Open source and decentralized
                  %p Iceberg is open source software. You can improve this software.
                  %p It is possible to download and upload encrypted files via API.
                  %p Anybody can duplicate and re-upload files.
                  %p
                    %a{:class => "btn btn-lg btn-primary", :href => 'https://github.com/ohac/iceberg'} GitHub
          %a{:class => "left carousel-control", :href => "#myCarousel", :role => "button", 'data-slide' => "prev"}
            %span{:class => "glyphicon glyphicon-chevron-left", 'aria-hidden' => true}
            %span{:class => "sr-only"} Previous
          %a{:class => "right carousel-control", :href => "#myCarousel", :role => "button", 'data-slide' => "next"}
            %span{:class => "glyphicon glyphicon-chevron-right", 'aria-hidden' => true}
            %span{:class => "sr-only"} Next

        %h1 Upload
        %ul#uploadtabs{:class => 'nav nav-tabs'}
          %li.active{:role => 'presentation'}
            %a{:href => '#filetab', 'aria-controls' => 'filetab', :role => :tab,
                'data-toggle' => 'tab'}
              %span{:class => 'glyphicon glyphicon-paperclip',
                'aria-hidden' => true}
              File
          %li{:role => 'presentation'}
            %a{:href => '#texttab', 'aria-controls' => 'texttab', :role => :tab,
                'data-toggle' => 'tab'}
              %span{:class => 'glyphicon glyphicon-pencil',
                'aria-hidden' => true}
              Text
        %div{:class => 'tab-content'}
          %div#filetab{:role => :tabpanel, :class => 'tab-pane active'}

            %form{:action => '/upload', :method => 'post',
                :enctype => 'multipart/form-data'}
              %br
              %label STEP 1
              %br
              %input{:type => 'file', :name => 'file'}
              Up to #{maxfilesize / (1024 * 1024)} MiB.
              %br
              %br
              %label STEP 2
              %br
              %button{:type => 'submit',
                  :class => 'btn btn-lg btn-default'}
                %span{:class => 'glyphicon glyphicon-cloud-upload',
                    'aria-hidden' => true}
                Upload
              %br
              %br
              %label Tripcode Tag (Option)
              %br
              %div{:class => 'input-group'}
                %span{:class => 'input-group-addon', :id => 'basic-addon1'}
                  %span{:class => 'glyphicon glyphicon-tag',
                    'aria-hidden' => true}
                  \#
                %input{:type => :text, :class => 'form-control',
                    :placeholder => 'Trip Key',
                    'aria-describedby' => 'basic-addon1', :name => 'tripkey'}

          %div#texttab{:role => :tabpanel, :class => 'tab-pane'}
            %form{:action => '/uploadtext', :method => 'post',
                :enctype => 'multipart/form-data'}
              %br
              %label STEP 1
              %br
              - title = Time.now.strftime('%Y-%m-%d %H:%M ')
              %input{:type => 'input', :name => 'title', :value => title,
                  :class => 'form-control'}
              %br
              %textarea{:rows => 10, :cols => 40, :name => 'text',
                  :class => 'form-control'}
              %br
              %label STEP 2
              %br
              %button{:type => 'submit',
                  :class => 'btn btn-lg btn-default'}
                %span{:class => 'glyphicon glyphicon-cloud-upload',
                    'aria-hidden' => true}
                Upload
              %br
              %br
              %label Tripcode Tag (Option)
              %br
              %div{:class => 'input-group'}
                %span{:class => 'input-group-addon', :id => 'basic-addon2'}
                  %span{:class => 'glyphicon glyphicon-tag',
                    'aria-hidden' => true}
                  \#
                %input{:type => :text, :class => 'form-control',
                    :placeholder => 'Trip Key',
                    'aria-describedby' => 'basic-addon2', :name => 'tripkey'}

        %hr
        %h1 Download
        %ul#downloadtabs{:class => 'nav nav-tabs'}
          %li.active{:role => 'presentation'}
            %a{:href => '#dltab', 'aria-controls' => 'dltab', :role => :tab,
                'data-toggle' => 'tab'}
              %span{:class => 'glyphicon glyphicon-file',
                'aria-hidden' => true}
              Files
          %li{:role => 'presentation'}
            %a{:href => '#tagtab', 'aria-controls' => 'tagtab', :role => :tab,
                'data-toggle' => 'tab'}
              %span{:class => 'glyphicon glyphicon-tag',
                'aria-hidden' => true}
              Tags
        %br
        %div{:class => 'tab-content'}
          %div#dltab{:role => :tabpanel, :class => 'tab-pane active'}
            - recentfiles.each do |file|
              - filename = "encrypted-#{file[0, 8]}"
              %div
                %a.files{:href => "/show/#{file}", :id => file}= filename
            %br
            #{recentfiles.size} / #{filemax} files in FIFO.
          %div#tagtab{:role => :tabpanel, :class => 'tab-pane'}
            - tripcodelist.each do |tripcode|
              %div
                %a.tripcodelist{:href => "/tripcode/#{tripcode}",
                    :id => tripcode}= tripcode
        %hr
        %h1 Cryptographic Keys
        All keys are stored on your browser's storage.
        %br
        It is important to backup keys.
        %br
        %textarea#metadata{:class => 'form-control', :rows => 10}
        %br
        %button#showkeys{:type => 'button', :class => 'btn btn-lg btn-default'}
          %span{:class => 'glyphicon glyphicon-open',
              'aria-hidden' => true}
          Show Keys
        %button#apply{:type => 'button', :class => 'btn btn-lg btn-default'}
          %span{:class => 'glyphicon glyphicon-save',
              'aria-hidden' => true}
          Import Keys
        %br
        %br
        %button#deleteall{:type => 'button',
            :class => 'btn btn-sm btn-default'}
          %span{:class => 'glyphicon glyphicon-trash', 'aria-hidden' => true}
          Forget All Keys
    %script{:type => 'text/javascript', :src => '/jquery-2.1.3.min.js'}
    %script{:type => 'text/javascript', :src => "#{cdn}/js/bootstrap.min.js"}
    %script{:type => 'text/javascript', :src => '/bootstrap-filestyle.min.js'}
    %script{:type => 'text/javascript', :src => '/index.js'}
